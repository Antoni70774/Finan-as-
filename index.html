<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Controle Financeiro</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header>
    <nav>
      <button id="menu-btn">‚ò∞</button>
      <h1>Finan√ßas</h1>
      <div class="icons">
        <button id="notifications-btn">üîî</button>
        <button id="profile-btn">üë§</button>
        <button id="settings-btn">‚öôÔ∏è</button>
      </div>
    </nav>
    <div id="user-info">
      <span id="current-user-name">Carregando...</span>
      <button id="btn-logout">Sair</button>
    </div>
  </header>

  <section id="date-navigation">
    <button id="prev-month">‚óÄ</button>
    <span id="current-month">Setembro de 2025</span>
    <button id="next-month">‚ñ∂</button>
  </section>

  <section id="dashboard">
    <div class="summary-card income">Receita <span id="total-income">R$ 0,00</span></div>
    <div class="summary-card expense">Despesa <span id="total-expense">R$ 0,00</span></div>
    <div class="summary-card balance">Saldo <span id="balance">R$ 0,00</span></div>
  </section>

  <section id="categories">
    <h2>Resumo por Categoria</h2>
    <ul id="category-summary"></ul>
  </section>

  <section id="transactions">
    <h2>Transa√ß√µes Recentes</h2>
    <ul id="transaction-list"></ul>
    <button id="open-transaction-modal">Nova Transa√ß√£o</button>
  </section>
  <!-- üßÆ Modal de Transa√ß√£o -->
  <div id="transaction-modal" class="modal hidden">
    <form id="transaction-form">
      <h3>Nova Transa√ß√£o</h3>
      <input type="hidden" id="transaction-id" />
      <label>Valor</label><input type="number" id="amount" required />
      <label>Descri√ß√£o</label><input type="text" id="description" required />
      <label>Categoria</label><input type="text" id="category" required />
      <label>Data</label><input type="date" id="date" required />
      <label>Tipo</label>
      <div class="type-buttons">
        <button type="button" id="type-expense-btn">Despesa</button>
        <button type="button" id="type-income-btn">Receita</button>
      </div>
      <input type="hidden" id="transaction-type" value="expense" />
      <div class="modal-actions">
        <button type="button" id="cancel-btn">Cancelar</button>
        <button type="submit">Salvar</button>
      </div>
    </form>
  </div>

  <!-- üîó Firebase SDK + inicializa√ß√£o -->
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js';
    import { getAuth, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js';
    import {
      getFirestore, enableIndexedDbPersistence, collection, doc,
      setDoc, getDocs, onSnapshot, writeBatch, updateDoc, deleteDoc
    } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js';

    const firebaseConfig = {
      apiKey: "AIzaSyBQeYc0Y-eYONv3ZfvZoJEzOjoKR371P-Y",
      authDomain: "controle-financeiro-65744.firebaseapp.com",
      projectId: "controle-financeiro-65744",
      storageBucket: "controle-financeiro-65744.appspot.com",
      messagingSenderId: "587527394934",
      appId: "1:587527394934:web:c142740ef0139a5cf63157",
      measurementId: "G-RT2T1HNV4G"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    try {
      await enableIndexedDbPersistence(db);
    } catch (e) {
      console.warn("IndexedDB n√£o dispon√≠vel:", e);
    }

    window.firebase = { auth, db, collection, doc, setDoc, getDocs, onSnapshot, writeBatch, updateDoc, deleteDoc };

    onAuthStateChanged(auth, (user) => {
      if (!user) {
        window.location.href = "login.html";
      } else {
        document.getElementById('current-user-name').textContent = user.email;
      }
    });

    document.getElementById('btn-logout').addEventListener('click', async () => {
      await signOut(auth);
      window.location.href = "login.html";
    });
  <!-- üßÆ Modal de Transa√ß√£o -->
  <div id="transaction-modal" class="modal hidden">
    <form id="transaction-form">
      <h3>Nova Transa√ß√£o</h3>
      <input type="hidden" id="transaction-id" />
      <label>Valor</label><input type="number" id="amount" required />
      <label>Descri√ß√£o</label><input type="text" id="description" required />
      <label>Categoria</label><input type="text" id="category" required />
      <label>Data</label><input type="date" id="date" required />
      <label>Tipo</label>
      <div class="type-buttons">
        <button type="button" id="type-expense-btn">Despesa</button>
        <button type="button" id="type-income-btn">Receita</button>
      </div>
      <input type="hidden" id="transaction-type" value="expense" />
      <div class="modal-actions">
        <button type="button" id="cancel-btn">Cancelar</button>
        <button type="submit">Salvar</button>
      </div>
    </form>
  </div>

  <!-- üîó Firebase SDK + inicializa√ß√£o -->
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js';
    import { getAuth, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js';
    import {
      getFirestore, enableIndexedDbPersistence, collection, doc,
      setDoc, getDocs, onSnapshot, writeBatch, updateDoc, deleteDoc
    } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js';

    const firebaseConfig = {
      apiKey: "AIzaSyBQeYc0Y-eYONv3ZfvZoJEzOjoKR371P-Y",
      authDomain: "controle-financeiro-65744.firebaseapp.com",
      projectId: "controle-financeiro-65744",
      storageBucket: "controle-financeiro-65744.appspot.com",
      messagingSenderId: "587527394934",
      appId: "1:587527394934:web:c142740ef0139a5cf63157",
      measurementId: "G-RT2T1HNV4G"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    try {
      await enableIndexedDbPersistence(db);
    } catch (e) {
      console.warn("IndexedDB n√£o dispon√≠vel:", e);
    }

    window.firebase = { auth, db, collection, doc, setDoc, getDocs, onSnapshot, writeBatch, updateDoc, deleteDoc };

    onAuthStateChanged(auth, (user) => {
      if (!user) {
        window.location.href = "login.html";
      } else {
        document.getElementById('current-user-name').textContent = user.email;
      }
    });

    document.getElementById('btn-logout').addEventListener('click', async () => {
      await signOut(auth);
      window.location.href = "login.html";
    });
